<% cache [locale_and_user_status, current_order, commentable_cache_key(record), comment_tree.comments, comment_tree.comment_authors, record.comments_count] do %>
  <div class="row comments">
    <div id="comments" class="small-12 column">
      <%= content %>

      <% if current_user %>
        <%= render "comments/form", { commentable: record, parent_id: nil } %>
      <% else %>
        <%= render "shared/login_to_comment" %>
      <% end %>

      <%= render Shared::OrderLinksComponent.new("comments", anchor: "comments") %>
      <%= render "comments/comment_list", comments: comment_tree.root_comments %>
      <%= paginate comment_tree.root_comments, params: { anchor: "comments" } %>
    </div>
  </div>
<% end %>
